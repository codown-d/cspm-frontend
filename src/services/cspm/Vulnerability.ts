import { request } from '@umijs/max';

export async function geVulnerabilityList(
  params: {
    /**
     * 云账户ids
     */
    credential_ids?: string[];
    /**
     * 是否仍然存在 0: 存在
     */
    status?: number;
    /**
     * 脆弱链名称（模糊搜索）
     */
    name?: string;
    page?: number;
    /**
     * 严重程度s
     */
    severities?: string[];
    size?: number;
  },
) {
  return request<API.ResponseWithItems<API.VulnerabilityItem>>(
    '/api/v1/fragilechain',
    {
      params: params,
      method: 'GET',
    },
  );
}

// 详情
export async function getVulnerabilityInfo(id: string) {
  return request<API.VulnerabilityInfo>(
    `/api/v1/fragilechain/detail`,
    {
      params: {id},
      method: 'GET',
    },
  );
}
